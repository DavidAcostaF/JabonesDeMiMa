{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="col text-center">
    <h1 style="background: #529c43; color: white; padding: 10px; border-radius: 15px; margin: 25px auto; font-size: 30px; width: 95%;">
        Agregar Gastos
    </h1>

    <form method="post" style="width: 95%; margin: 0 auto;">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <!-- Fila: Proveedor -->
        <div class="mb-4 text-start">
            <label style="color: #529c43; font-weight: bold;">Proveedor</label>
            {{ form.proveedor }}
        </div>

        <!-- Fila: Folio -->
        <div class="mb-4 text-start">
            <label style="color: #529c43; font-weight: bold;">Folio del comprobante</label>
            {{ form.receipt_folio }}
        </div>

        <!-- Fila: Descripción -->
        <div class="mb-4 text-start">
            <label style="color: #529c43; font-weight: bold;">Concepto</label>
            {{ form.description }}
        </div>

        <!-- Fila combinada: Categoría - Fecha - IVA -->
        <div class="row mb-4 text-start">
            <div class="col-md-4">
                <label style="color: #529c43; font-weight: bold;">Categoría</label>
                {{ form.type }}
                <div class="mb-4 text-start" id="nueva-categoria-contenedor" style="display: none;">
                    <label style="color: #529c43; font-weight: bold;">¿Nueva categoría?</label>
                    {{ form.nueva_categoria }}
                    <small class="form-text text-muted">Si ingresas una nueva, se registrará automáticamente.</small>
                </div>
            </div>
            <div class="col-md-4">
                <label style="color: #529c43; font-weight: bold;">Fecha</label>
                {{ form.date }}
            </div>
            <div class="col-md-4">
                <label style="color: #529c43; font-weight: bold;">IVA</label>
                {{ form.tax }}
            </div>
        </div>

        <!-- Fila: Subtotal -->
        <div class="mb-4 text-start">
            <label style="color: #529c43; font-weight: bold;">Subtotal</label>
            {{ form.sub_total }}
        </div>

        <!-- Fila: Total -->
        <div class="mb-4 text-start">
            <label style="color: #529c43; font-weight: bold;">Total</label>
            {{ form.total }}
        </div>

        

        <!-- Botones -->
        <div class="d-flex justify-content-between mt-5">
            <a href="{% url 'expenses:index' %}" class="btn text-white"
               style="background-color: #529c43; border-radius: 15px; font-size: 20px; padding: 10px 100px;">
                Volver
            </a>
            <button type="submit" class="btn text-white"
               style="background-color: #529c43; border-radius: 15px; font-size: 20px; padding: 10px 100px;">
                Agregar
            </button>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tipoSelect = document.getElementById("id_type");
        const nuevaCategoria = document.getElementById("nueva-categoria-contenedor");

        function toggleNuevaCategoria() {
            if (tipoSelect.value === "otra") {
                nuevaCategoria.style.display = "block";
            } else {
                nuevaCategoria.style.display = "none";
                const input = nuevaCategoria.querySelector("input");
                if (input) input.value = "";  // Limpia si cambia de opinión
            }
        }

        tipoSelect.addEventListener("change", toggleNuevaCategoria);
        toggleNuevaCategoria(); // Ejecuta por si ya está seleccionada
    });
</script>
{% endblock %}
